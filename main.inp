$================================== INITIALIZATION ==================================
$ Include Mask
MASK IN.FILE =mask.tl1 PRINT

$ Background Doping
INITIALIZE BORON=1E15

$ Grow buried layer masking oxide
DIFFUSION TEMP=950 TIME=30 DRY

ELECTRICAL
$================================== INITIALIZED ==================================

$================================== START of DOPING ==================================
DEPOSIT PHOTORESIST THICKNESS = 4
EXPOSE MASK=NMASKPMOS
DEVELOP
$random gaussian, hence dopign it multiple times refines the edges
IMPLANT ARSENIC DOSE=1.766E12 ENERGY=300 TILT=0 ROTATION=20
IMPLANT ARSENIC DOSE=1.766E12 ENERGY=300 TILT=0 ROTATION=20
ETCH PHOTORESIST ALL

$Additional doping made to the NMOS to achieve the threshold voltage
DEPOSIT PHOTORESIST THICKNESS = 4
EXPOSE MASK=PMASKNMOS
DEVELOP
IMPLANT BORON DOSE=9E12 ENERGY=200 TILT=0 ROTATION=20
IMPLANT BORON DOSE=9E12 ENERGY=200 TILT=0 ROTATION=20
ETCH PHOTORESIST ALL

$no threshold voltage required, well can be deeper
$deeper well also means easier PN junction
DEPOSIT PHOTORESIST THICKNESS = 4
EXPOSE MASK=NMASK
DEVELOP
IMPLANT ARSENIC DOSE=5E14 ENERGY=400 TILT=0 ROTATION=20
IMPLANT ARSENIC DOSE=5E14 ENERGY=400 TILT=0 ROTATION=20
ETCH PHOTORESIST ALL

$well inside well for resistor and BJT
DEPOSIT PHOTORESIST THICKNESS = 4
EXPOSE MASK=PMASK
DEVELOP
IMPLANT BORON DOSE=2E15 ENERGY=35 TILT=0 ROTATION=20
IMPLANT BORON DOSE=2E15 ENERGY=35 TILT=0 ROTATION=20
ETCH PHOTORESIST ALL

$well inside well for n+ contact points
DEPOSIT PHOTORESIST THICKNESS = 4
EXPOSE MASK=NNMASK
DEVELOP
IMPLANT ARSENIC DOSE=1E16 ENERGY=20 TILT=0 ROTATION=20
IMPLANT ARSENIC DOSE=1E16 ENERGY=20 TILT=0 ROTATION=20
ETCH PHOTORESIST ALL

$well inside well for p+ contact points, the contact for diode is done seperately
DEPOSIT PHOTORESIST THICKNESS = 4
EXPOSE MASK=PPMASK
DEVELOP
IMPLANT BORON DOSE=3E12 ENERGY=20 TILT=0 ROTATION=20
IMPLANT BORON DOSE=3E12 ENERGY=20 TILT=0 ROTATION=20
ETCH PHOTORESIST ALL

$This can be deeper, hence we dope this seperately from PPMASK
DEPOSIT PHOTORESIST THICKNESS = 4
EXPOSE MASK=PPMASKDIODE
DEVELOP
IMPLANT BORON DOSE=0.8E15 ENERGY=20 TILT=0 ROTATION=20
IMPLANT BORON DOSE=0.8E15 ENERGY=20 TILT=0 ROTATION=20
ETCH PHOTORESIST ALL

$================================== END OF DOPING ==================================

$================================== START of STRUCTURE ==================================

$Only 0.05 micrometer exisiting, adding some layers to work with
$Deposite does not affect our doping
DEPOSIT OXIDE THICKNESS = 0.6

$Etch position to place device
DEPOSIT PHOTORESIST THICK=1.0
EXPOSE MASK=Oxide
DEVELOP
ETCH OXIDE THICK=1
ETCH PHOTORESIST ALL

$Etch position for MOS is done seperately because an layer of gate oxide is required
DEPOSIT PHOTORESIST THICK=1.0
EXPOSE MASK=MOS
DEVELOP
ETCH OXIDE THICK=0.6
ETCH PHOTORESIST ALL

$Etching everything apart from the gate oxide for the MOS
DEPOSIT PHOTORESIST THICK=1.0
EXPOSE MASK=MOSGATE
DEVELOP
ETCH OXIDE THICK=0.6
ETCH PHOTORESIST ALL

$Removing enough oxide for gate

$ Putting down polysilicon
MATERIAL MAT=POLY ^POLYCRYS
DEPOSIT POLYSILICON THICK=0.1
DEPOSIT PHOTORESIST THICK=1.0
EXPOSE MASK=Poly
DEVELOP
ETCH POLYSILICON TRAP THICK=1
ETCH PHOTORESIST ALL

$ Oxidize the polysilicon gate, INERT gas doesn't seems to affect doping too much
DIFFUSION TIME=30 TEMP=1000 INERT

$This is not necessary, but can make the aluminum appears flat
DEPOSIT ALUMINUM THICK=5
ETCH ALUMINUM THICK=5
DEPOSIT ALUMINUM THICK=5
ETCH ALUMINUM THICK=5

$Removing the excess aluminum for the metal contact
DEPOSIT PHOTORESIST THICK=1.0
EXPOSE MASK=Metal
DEVELOP
ETCH ALUMINUM THICK=1.0
ETCH PHOTORESIST ALL

ELECTRICAL

$Fill the gap between the contacts and smoothen them out with oxide
DEPOSIT PHOTORESIST THICK=0.5
EXPOSE MASK=Metal
DEVELOP
DEPOSIT OXIDE THICK=2
ETCH OXIDE THICK = 2.5
ETCH PHOTORESIST ALL

$Not NECESSARY
$DEPOSIT PHOTORESIST NEGATIVE THICK=1.0
$EXPOSE MASK=ALLDEVICE
$DEVELOP
$ETCH POLYSILICON TRAP THICK=0.7 ANGLE=79
$ETCH OXIDE THICK=1
$ETCH PHOTORESIST ALL
$DEPOSIT OXIDE THICK=0.6504

$================================== END of STRUCTURE ==================================

$================================== START of DATA EXPORTING ==================================

SELECT Z=LOG10(BORON) TITLE="Etching"
PLOT.2D SCALE Y.MAX=1 Y.MIN=-3
$ Color fill the regions
COLOR SILICON COLOR=7
COLOR POLY COLOR=6
COLOR OXIDE COLOR=5
COLOR ALUM COLOR=2
ETCH PHOTORESIST ALL

ELECTRICAL X=2 THRESHOLD NMOS V="0 2 0.1"
ELECTRICAL X=6 THRESHOLD NMOS V="0 2 0.1"

$================================== END of DATA EXPORTING ==================================

SAVEFILE OUT.FILE=wafer.tif tif